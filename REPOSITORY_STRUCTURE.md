# Repository Structure

This repository contains the RPT (Robust Predicate Transfer) evaluation on the Star Schema Benchmark (SSB).

## Directory Structure

```
RPT-SSB-ASSESSMENT/
├── README.md                          # Main project README
├── EXPERIMENT_GUIDE.md                # Guide for running experiments
├── SCALING_UP_GUIDE.md                # Guide for scaling to higher SF
├── REPOSITORY_STRUCTURE.md            # This file
│
├── runner/                            # Experiment execution scripts
│   ├── run_all_experiments.sh         # Main experiment orchestrator
│   ├── run_all_scale_factors.sh       # Multi-SF experiment runner
│   ├── run_experiments.py             # Query execution script
│   ├── measure_join_sizes.py          # Join size measurement
│   ├── measure_memory.py              # Memory utilization measurement
│   ├── analyze_results.py             # Results analysis
│   ├── create_graphs.py               # Graph generation (SF=1)
│   └── create_graphs_for_scale_factor.py  # Graph generation (SF=5,10)
│
├── scripts/                           # Utility scripts
│   ├── generate_higher_sf.sh          # Generate SSB data for higher SF
│   ├── cleanup_space.sh               # Clean up disk space
│   └── update_for_scale_factor.sh     # Update SQL for scale factor
│
├── sql/                               # SQL scripts
│   └── load_ssb.sql                   # SSB schema and data loading
│
├── results/                           # Experiment results
│   ├── sf1/                           # SF=1 results
│   │   ├── ssb_baseline.csv
│   │   ├── ssb_rpt.csv
│   │   ├── memory_baseline.csv
│   │   ├── memory_rpt.csv
│   │   ├── join_sizes_baseline.csv
│   │   └── join_sizes_rpt.csv
│   ├── sf5/                           # SF=5 results
│   │   ├── ssb_baseline.csv
│   │   ├── ssb_rpt.csv
│   │   ├── memory_baseline.csv
│   │   ├── memory_rpt.csv
│   │   ├── join_sizes_baseline.csv
│   │   └── join_sizes_rpt.csv
│   ├── sf10/                          # SF=10 results
│   │   ├── ssb_baseline.csv
│   │   ├── ssb_rpt.csv
│   │   ├── memory_baseline.csv
│   │   ├── memory_rpt.csv
│   │   ├── join_sizes_baseline.csv
│   │   └── join_sizes_rpt.csv
│   └── graphs/                        # Visualization graphs
│       ├── sf1/                       # SF=1 graphs
│       │   ├── performance_comparison.png
│       │   ├── speedup_comparison.png
│       │   ├── memory_comparison.png
│       │   ├── join_size_comparison.png
│       │   └── summary_comparison.png
│       ├── sf5/                       # SF=5 graphs
│       │   ├── performance_comparison.png
│       │   ├── speedup_comparison.png
│       │   ├── memory_comparison.png
│       │   ├── join_size_comparison.png
│       │   └── summary_comparison.png
│       └── sf10/                      # SF=10 graphs
│           ├── performance_comparison.png
│           ├── speedup_comparison.png
│           ├── memory_comparison.png
│           ├── join_size_comparison.png
│           └── summary_comparison.png
│
├── presentation_outline.md            # Presentation outline
├── presentation_script.md             # Full presentation script
├── presentation_future_work_script.md # Future work section
│
├── duckdb-rpt/                        # RPT-enabled DuckDB fork
│   ├── rpt-src/                       # Source code (from EmbryoLabs)
│   │   ├── src/include/duckdb/optimizer/predicate_transfer/setting.hpp
│   │   └── ...                        # Full DuckDB source
│   ├── ssb_sf5.db                     # SF=5 database
│   └── ssb_sf10.db                    # SF=10 database
│
└── ssb-data/                          # SSB generated data
    ├── sf1/                           # SF=1 data (can be regenerated)
    ├── sf5/                           # SF=5 data (can be regenerated)
    ├── sf10/                          # SF=10 data (can be regenerated)
    └── ssb-dbgen/                     # SSB data generator
```

## Key Results

### SF=1 Results
- **No significant improvement** - dataset too small for RPT benefits
- Results preserved for comparison

### SF=5 Results
- **Average Speedup:** 1.34x (25.4% faster)
- **All 13 queries improved** with RPT
- **Best improvement:** q4.1 at +42%

### SF=10 Results
- **Average Speedup:** 1.35x (26.0% faster)
- **All 13 queries improved** with RPT
- **Best improvement:** q4.1 at +45.9%

## Quick Start

1. **Build DuckDB with RPT:**
   ```bash
   cd duckdb-rpt/rpt-src
   mkdir -p build && cd build
   cmake .. && make -j$(nproc)
   ```

2. **Run experiments:**
   ```bash
   cd runner
   ./run_all_scale_factors.sh
   ```

3. **View results:**
   - CSV files: `results/sf1/`, `results/sf5/`, and `results/sf10/`
   - Graphs: `results/graphs/sf1/`, `results/graphs/sf5/`, and `results/graphs/sf10/`

## Notes

- Build artifacts can be regenerated by running `cmake` and `make` in `duckdb-rpt/rpt-src/build/`
- SSB data files can be regenerated using `scripts/generate_higher_sf.sh`
- Old results and logs have been moved to `.cleanup_backup_*/` directories
